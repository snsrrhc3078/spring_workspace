<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:jee="http://www.springframework.org/schema/jee"
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
								  http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
								  http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">
	
	<!-- Root Context: defines shared resources visible to all other web components -->
	<!-- 스프링의 트랜잭션등의 도움을 받기 위해서는, 스프링이 db 커넥션을
	취득해야 한다..따라서 스프링에서 jndi를 사용하자 -->
	<!-- 전자정부프레임워크에서 jee를 가져오고, 경로와 p도 가져오자ㅏ -->
	<jee:jndi-lookup 
		id="dataSource" 
		jndi-name="jdbc/oracle"
		resource-ref="true"/>
		
	<!--
		기술에 따른 트랜잭션 매니저를 빈으로 등록
		JDBC - DataSourceTransactionManager
		Mybatis - DataSourceTransactionManager(같은 이유는 Mybatis도 내부는 JDBC로 되어있기 때문)
		Hibernate - HibernateTransactionManager
	 -->
	<bean id="TransactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"
		p:dataSource-ref="dataSource"/><!-- p가 위에 lookup을 가져오는 태그 -->

	<!-- SqlSessionTemplate 을 얻기위한 SqlSessionFactoryBean 등록 
			원래 Mybatis가 취득했던 커넥션을 스프링이 뺏었기 때문에, dataSource-ref로
			DB정보를 SqlSessionFactoryBean에 넣어주자-->
	<!--lookup의 datasource를 가지고 와야 하는데, 이것은 mybatis의 데이터풀 설정을 spring이 뺏엇기 때문 , 참고: ref있는 것은 객체를 가져올때 사용 -->
	<bean id="sqlSessionFactoryBean" 
		class="org.mybatis.spring.SqlSessionFactoryBean"
		p:dataSource-ref="dataSource"
		p:configLocation="classpath:com/edu/springboard/mybatis/config.xml"/>
	
	<bean id="sqlSessionTemplate" class="org.mybatis.spring.SqlSessionTemplate">
		<constructor-arg name="sqlSessionFactory" ref="sqlSessionFactoryBean"/>
	</bean>	
	
	<context:component-scan base-package="com.edu.springboard.model"></context:component-scan>
	
</beans>
